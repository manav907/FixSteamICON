"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const WebSocketBase_1 = __importDefault(require("./WebSocketBase"));
const State_1 = __importDefault(require("./enums/State"));
class WebSocketServerConnection extends WebSocketBase_1.default {
    constructor(socket, options, handshakeData, head, extensions) {
        super();
        options = options || {};
        Object.assign(this.options, options);
        this.state = State_1.default.Connected;
        this.handshakeData = handshakeData;
        this._extensions = extensions;
        this.protocol = handshakeData.selectedProtocol || null;
        this._socket = socket;
        this._type = 'server';
        this._prepSocketEvents();
        if (head && head.length > 0) {
            this._dataBuffer = head; // don't call _handleData just yet, as there are no event listeners bound
        }
        this._onConnected();
    }
}
exports.default = WebSocketServerConnection;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiV2ViU29ja2V0U2VydmVyQ29ubmVjdGlvbi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy9XZWJTb2NrZXRTZXJ2ZXJDb25uZWN0aW9uLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBRUEsb0VBQTRDO0FBSzVDLDBEQUFrQztBQUVsQyxNQUFxQix5QkFBMEIsU0FBUSx1QkFBYTtJQUduRSxZQUNDLE1BQXdCLEVBQ3hCLE9BQTZCLEVBQzdCLGFBQTRCLEVBQzVCLElBQVksRUFDWixVQUErQjtRQUUvQixLQUFLLEVBQUUsQ0FBQztRQUVSLE9BQU8sR0FBRyxPQUFPLElBQUksRUFBRSxDQUFDO1FBQ3hCLE1BQU0sQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxPQUFPLENBQUMsQ0FBQztRQUVyQyxJQUFJLENBQUMsS0FBSyxHQUFHLGVBQUssQ0FBQyxTQUFTLENBQUM7UUFDN0IsSUFBSSxDQUFDLGFBQWEsR0FBRyxhQUFhLENBQUM7UUFDbkMsSUFBSSxDQUFDLFdBQVcsR0FBRyxVQUFVLENBQUM7UUFDOUIsSUFBSSxDQUFDLFFBQVEsR0FBRyxhQUFhLENBQUMsZ0JBQWdCLElBQUksSUFBSSxDQUFDO1FBRXZELElBQUksQ0FBQyxPQUFPLEdBQUcsTUFBTSxDQUFDO1FBQ3RCLElBQUksQ0FBQyxLQUFLLEdBQUcsUUFBUSxDQUFDO1FBRXRCLElBQUksQ0FBQyxpQkFBaUIsRUFBRSxDQUFDO1FBQ3pCLElBQUksSUFBSSxJQUFJLElBQUksQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFO1lBQzVCLElBQUksQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDLENBQUMseUVBQXlFO1NBQ2xHO1FBRUQsSUFBSSxDQUFDLFlBQVksRUFBRSxDQUFDO0lBQ3JCLENBQUM7Q0FDRDtBQTlCRCw0Q0E4QkMifQ==